{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/buttonService.js","../src/js/refs.js","../src/js/readForm.js","../src/js/handleLoadMore.js","../src/js/handleSearch.js","../src/main.js"],"sourcesContent":["// Описаний в документації\nimport axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"49486452-3d44cfba97bed6ab675a762ac\";\n\nasync function getPhotos({ page, perPage, query }) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    page: page,\n    per_page: perPage,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n  });\n\n  return (await axios.get(`${BASE_URL}?${params}`)).data;\n}\n\nexport { getPhotos };\n","// create a template\nfunction processImage({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  const liTemplate = `\n  <div class=\"gallery-item\">\n    <li>\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n        />\n      </a>\n    </li>\n    <ul class=\"gallery-ul\">\n      <li class=\"gallery-li\">\n        <p>Likes</p>\n        <p>${likes}</p>\n      </li>\n      <li class=\"gallery-li\">\n        <p>Views</p>\n        <p>${views}</p>\n      </li>\n      <li class=\"gallery-li\">\n        <p>Comments</p>\n        <p>${comments}</p>\n      </li>\n      <li class=\"gallery-li\">\n        <p>Downloads</p>\n        <p>${downloads}</p>\n      </li>\n    </ul>\n  </div>`;\n  return liTemplate;\n}\n\nfunction updateGallery(photos) {\n  return photos.map(processImage).join(\"\");\n}\n\nexport { updateGallery };\n","export default class LoadMoreButton {\n  static HIDDEN_CLASS = \"is-hidden\";\n\n  constructor(buttonEl) {\n    this.button = buttonEl;\n    this.prevText = \"\";\n  }\n\n  disable() {\n    this.button.disabled = true;\n    this.prevText = this.button.textContent;\n    this.button.textContent = \"Loading...\";\n  }\n\n  enable() {\n    this.button.disabled = false;\n    this.button.textContent = this.prevText || this.button.textContent;\n  }\n\n  hide() {\n    this.button.classList.add(LoadMoreButton.HIDDEN_CLASS);\n  }\n\n  show() {\n    this.button.classList.remove(LoadMoreButton.HIDDEN_CLASS);\n  }\n}\n\nexport { LoadMoreButton };\n","import LoadMoreButton from \"./buttonService\";\nimport SimpleLightbox from \"simplelightbox\";\n\nconst refs = {\n  form: document.querySelector(\".js-form\"),\n  gallery: document.querySelector(\".js-gallery\"),\n  notFoundText: document.querySelector(\".js-not-found-text\"),\n  loader: document.querySelector(\".js-loader\"),\n  loadMoreBtn: document.querySelector(\".js-load-more\"),\n};\n\nconst ACTIVE_CLASS = \"active\";\n\nconst queryParams = {\n  page: 1,\n  perPage: 15,\n  query: \"\",\n  maxPage: 1,\n};\n\nconst loadMoreButton = new LoadMoreButton(refs.loadMoreBtn);\nconst simpleLight = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nexport { refs, ACTIVE_CLASS, queryParams, loadMoreButton, simpleLight };\n","import iziToast from \"izitoast\";\nimport { refs } from \"./refs\";\n\nfunction readQuery(event) {\n  event.preventDefault();\n  refs.notFoundText.innerHTML = \"\";\n\n  const form = event.currentTarget;\n  const userQuery = form.elements.user_query.value.trim();\n  console.dir(userQuery);\n\n  if (userQuery === \"\") {\n    iziToast.show({\n      title: \"\",\n      message: `Введіть будь-ласка запит!`,\n    });\n    return;\n  }\n\n  return userQuery;\n}\n\nexport { readQuery };\n","import { handleSearch } from \"./handleSearch\";\nimport { getPhotos } from \"./pixabay-api\";\nimport { loadMoreButton, queryParams, refs, simpleLight } from \"./refs\";\nimport { updateGallery } from \"./render-functions\";\nimport iziToast from \"izitoast\";\n\nasync function handleLoadMore(event) {\n  queryParams.page += 1;\n  loadMoreButton.disable();\n  console.log(\"Page is: \", queryParams.page);\n\n  // check if current page is maxpage\n  if (queryParams.page >= queryParams.maxPage) {\n    iziToast.show({\n      title: \"\",\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    loadMoreButton.hide();\n    loadMoreButton.button.removeEventListener(\"submit\", handleSearch);\n    return;\n  }\n\n  // if there is still more photos, try to get them\n  try {\n    const photos = await getPhotos(queryParams);\n\n    if (photos.total === 0) {\n      loadMoreButton.hide();\n      loadMoreButton.button.removeEventListener(\"click\", handleLoadMore);\n      return;\n    }\n\n    // update gallery\n    const postsMarkup = updateGallery(photos.hits);\n\n    refs.gallery.insertAdjacentHTML(\"beforeend\", postsMarkup);\n\n    // add Simplebox delay and alt\n    simpleLight.refresh();\n\n    // smooth scrolling\n    const image = document.querySelector(\".gallery-image\");\n    const rect = image.getBoundingClientRect();\n\n    window.scrollBy({\n      top: rect.height * 2, // Vertical distance to scroll\n      behavior: \"smooth\", // Smooth scrolling effect\n    });\n\n    // enable button\n    loadMoreButton.enable();\n    if (queryParams.page >= queryParams.maxPage) {\n      iziToast.show({\n        title: \"\",\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      loadMoreButton.hide();\n      loadMoreButton.button.removeEventListener(\"submit\", handleSearch);\n    }\n  } catch (err) {\n    console.log(err);\n    loadMoreButton.hide();\n  }\n}\n\nexport { handleLoadMore };\n","import iziToast from \"izitoast\";\n\nimport { getPhotos } from \"./pixabay-api.js\";\nimport { updateGallery } from \"./render-functions.js\";\nimport {\n  ACTIVE_CLASS,\n  loadMoreButton,\n  queryParams,\n  refs,\n  simpleLight,\n} from \"./refs.js\";\nimport { readQuery } from \"./readForm.js\";\nimport { handleLoadMore } from \"./handleLoadMore.js\";\n\nfunction handleSearch(event) {\n  // read users query\n  queryParams.query = readQuery(event);\n  if (!queryParams.query) return;\n  queryParams.page = 1;\n\n  // add loader start\n  refs.loader.classList.add(ACTIVE_CLASS);\n\n  // get photos from pixabay server and process them\n  getPhotos(queryParams)\n    .then(photos => {\n      // remove loader\n      refs.loader.classList.remove(ACTIVE_CLASS);\n\n      console.dir(photos);\n      // check received total amount of photos and return if empty\n      if (photos.total === 0) {\n        refs.gallery.innerHTML = \"\";\n        loadMoreButton.hide();\n        iziToast.show({\n          title: \"\",\n          message:\n            \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n\n        return;\n      }\n\n      // store maxpage value\n      queryParams.maxPage = Math.ceil(photos.total / queryParams.perPage);\n      // update gallery with received photos\n      refs.gallery.innerHTML = updateGallery(photos.hits);\n      console.log(\"Max page is: \", queryParams.maxPage);\n      console.log(\"Page is: \", queryParams.page);\n\n      simpleLight.refresh();\n\n      const image = document.querySelector(\".gallery-image\");\n      const rect = image.getBoundingClientRect();\n\n      window.scrollBy({\n        //   top: rect.top * 2, // Vertical distance to scroll\n        behavior: \"smooth\", // Smooth scrolling effect\n      });\n\n      if (queryParams.page >= queryParams.maxPage) {\n        loadMoreButton.hide();\n        loadMoreButton.button.removeEventListener(\"submit\", handleSearch);\n        return;\n      }\n\n      loadMoreButton.show();\n      loadMoreButton.button.addEventListener(\"click\", handleLoadMore);\n    })\n    .catch(err => {\n      refs.loader.classList.remove(ACTIVE_CLASS);\n      console.log(err);\n    })\n    .finally(() => {\n      refs.form.reset();\n    });\n}\n\nexport { handleSearch };\n","import { handleSearch } from \"./js/handleSearch.js\";\nimport { refs } from \"./js/refs.js\";\n\nrefs.form.addEventListener(\"submit\", handleSearch);\n"],"names":["BASE_URL","API_KEY","getPhotos","page","perPage","query","params","axios","processImage","webformatURL","largeImageURL","tags","likes","views","comments","downloads","updateGallery","photos","_LoadMoreButton","buttonEl","__publicField","LoadMoreButton","refs","ACTIVE_CLASS","queryParams","loadMoreButton","simpleLight","SimpleLightbox","readQuery","event","userQuery","iziToast","handleLoadMore","handleSearch","postsMarkup","rect","err"],"mappings":"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"}